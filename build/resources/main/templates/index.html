<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <link rel="shortcut icon" th:href="@{/assets/img/escudo-ucam.svg}"  type="image/x-icon"/>
    <title>Buscador de personas UCAM</title>

    <link th:href="@{/assets/plugins/ucam-icons/styles.css}"  rel="stylesheet"/>
    <link th:href="@{/assets/css/main.css}"  rel="stylesheet"/>

</head>

<body>

<article class="personas-portada">
    <div class="navbar-wrapper">
        <nav class="navbar navbar-light justify-content-between">
            <a class="navbar-brand">
                <img class="img-fluid" th:src="@{/assets/img/logo.svg}" width="200" height="50" alt="Logo UCAM Personas">
            </a>

        </nav>
    </div>

    <section class="portada vh-100 background-image">

        <picture>
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-escritorio1920.webp}" media="(min-width: 1200px)" type="image/webp"/>
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-escritorio1920.jpg}" media="(min-width: 1200px)" type="image/jpeg">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-ipad-pro-horizontal1366.webp}" media="(min-width: 992px) and (orientation: landscape)" type="image/webp">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-ipad-pro-horizontal1366.jpg}" media="(min-width: 992px) and (orientation: landscape)" type="image/jpeg">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-ipad-pro-vertical1024.webp}" media="(min-width: 992px) and (orientation: portrait)" type="image/webp">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-ipad-pro-vertical1024.jpg}" media="(min-width: 992px) and (orientation: portrait)" type="image/jpeg">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-ipad-horizontal1024.webp}" media="(min-width: 768px) and (orientation: landscape)" type="image/webp">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-ipad-horizontal1024.jpg}" media="(min-width: 768px) and (orientation: landscape)" type="image/jpeg">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-ipad-vertical768.webp}" media="(min-width: 768px) and (orientation: portrait)" type="image/webp">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-ipad-vertical768.jpg}" media="(min-width: 768px) and (orientation: portrait)" type="image/jpeg">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-movil-horizontal800.webp}" media="(min-width: 0px) and (orientation: landscape)" type="image/webp">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-movil-horizontal800.jpg}" media="(min-width: 0px) and (orientation: landscape)" type="image/jpeg">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-movil450.webp}" media="(min-width: 0px) and (orientation: portrait)" type="image/webp">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-movil450.jpg}" media="(min-width: 0px) and (orientation: portrait)" type="image/jpeg">

            <img th:src="@{/assets/img/portada/portada-ucam-4-escritorio1920.jpg}" alt="Vista del monasterio de los Jerónimos | Home">
        </picture>
        <div class="form-wrapper">
            <form id="searchPortadaForm" th:action="@{/resultados}">
                <div class="input-group">
                <span class="input-group-prepend">
                    <div class="input-group-text bg-light border-right-0"><i class="icon-lupa"></i></div>
                </span>
                <input id="busqueda" type="text" autocomplete="off" class="form-control py-2 border-left-0" name="search" placeholder="Nombre, apellidos, extensión, email">
                <button type="submit" class="btn buscar">Buscar</button>
                </div>
                <div id="sugerencias"></div>
            </form>
        </div>
    </section>

</article>

<script type="text/javascript" th:src="@{/assets/js/vendor/jquery.slim.min.js}"></script>
<script type="text/javascript" th:src="@{/assets/js/vendor/bootstrap.min.js}"></script>
<script type="text/javascript" th:src="@{/assets/js/vendor/popper.min.js}"></script>
<script type="text/javascript" th:src="@{/assets/js/main.scripts.js}"></script>

<script src="//code.jquery.com/jquery-3.5.1.min.js"></script>
<script>
    $(document).ready(function() {
        var $busqueda = $('#busqueda');
        var $sugerencias = $('#sugerencias');

        $busqueda.on('input', function() {

            if($(this).val().length > 0){
                $('.buscar').css('background-color', '#2d3d4a');
            }else{
                $('.buscar').css('background-color', '#a8a8a8');
            }

            $.getJSON('/search', { nombre: $busqueda.val(), apellidos: $busqueda.val()})
                .done(function(personasEncontradas) {
                    $sugerencias.empty();

                    personasEncontradas.forEach(function(persona) {
                        var nombre = persona.nombre + ' ' + persona.apellidos;
                        var $option = $('<a href="/perfil/'+persona.id+'" >'+nombre+'</a>')

                        $sugerencias.append($option);
                    });
                })
                .fail(function() {
                    console.log('Error al buscar personas');
                });
            });
        });

</script>

</body>
</html>
