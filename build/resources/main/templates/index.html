<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <link rel="shortcut icon" th:href="@{/assets/img/escudo-ucam.svg}"  type="image/x-icon"/>
    <title>Buscador de personas UCAM</title>

    <link rel="stylesheet" th:href="@{/assets/plugins/ucam-icons/styles.css}" />
    <link rel="stylesheet" th:href="@{/assets/css/swiper.min.css}" />
    <link rel="stylesheet" th:href="@{/assets/css/main.styles.css}"/>
    <link rel="stylesheet" th:href="@{/assets/css/swiper.min.css}"/>
    <link rel="stylesheet" th:href="@{/assets/css/styles.css}"/>
    <link rel="stylesheet" th:href="@{/assets/css/portada.component.css}"/>

</head>

<body>

<article class="personas-portada">
    <div class="navbar-wrapper">
        <nav class="navbar navbar-light justify-content-between">
            <a class="navbar-brand">
                <img class="img-fluid" th:src="@{/assets/img/logo.svg?0102}" width="200" height="50" alt="Logo UCAM Personas">
            </a>

            <!-- login
            <div class="dropdown">
              <a class="decoration-none" href="#" id="loginButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <span class="icon-button icon-perm-identity text-color-ucam-gray-medium"></span>
              </a>
              <div class="dropdown-menu dropdown-menu-right text-center p-3" aria-labelledby="loginButton">
                <span class="icon-button icon-button-xl text-size-subtitulo1 icon-perm-identity text-color-ucam-gray-medium"></span>
                <p class="dropdown-header">Iniciar sesión</p>
                <form id="loginForm" action="#">
                  <button type="submit" class="btn btn-info">Iniciar sesión</button>
                </form>
              </div>
            </div>

            <div class="dropdown">
              <a class="decoration-none rounded-circle" href="#" id="loginButton2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <img src="data:image/png;base64," alt="Miguel Ángel Abenza" class="img-fluid" width="36">
              </a>
              <div class="dropdown-menu dropdown-menu-right text-center p-3" aria-labelledby="loginButton">

                <a href="#" title="Editar foto" class="edit-photo-link">
                  <div class="photo-mask">
                    <img src="data:image/png;base64," alt="Miguel Ángel Abenza" width="70">
                  </div>
                  <span class="edit-photo">
                    <img th:src="@{assets/img/icon-camera.svg}" alt="Icono editar foto">
                  </span>
                </a>

                <p class="dropdown-header"></p>
                <p>
                  <small></small>
                </p>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="http://key.ucam.edu">
                  <i class="icon-key"></i> Cambiar contraseña</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="https://inf.ucam.edu/personasucam/">
                  <i class="icon-ajustes"></i> Modificar privacidad</a>
                <div class="dropdown-divider"></div>

                <button type="button" class="btn btn-info mt-3">Cerrar sesión</button>

              </div>
            </div>-->

        </nav>
    </div>

    <section class="portada vh-100 background-image">

        <picture>
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-escritorio1920.webp}" media="(min-width: 1200px)" type="image/webp"/>
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-escritorio1920.jpg}" media="(min-width: 1200px)" type="image/jpeg">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-ipad-pro-horizontal1366.webp}" media="(min-width: 992px) and (orientation: landscape)" type="image/webp">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-ipad-pro-horizontal1366.jpg}" media="(min-width: 992px) and (orientation: landscape)" type="image/jpeg">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-ipad-pro-vertical1024.webp}" media="(min-width: 992px) and (orientation: portrait)" type="image/webp">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-ipad-pro-vertical1024.jpg}" media="(min-width: 992px) and (orientation: portrait)" type="image/jpeg">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-ipad-horizontal1024.webp}" media="(min-width: 768px) and (orientation: landscape)" type="image/webp">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-ipad-horizontal1024.jpg}" media="(min-width: 768px) and (orientation: landscape)" type="image/jpeg">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-ipad-vertical768.webp}" media="(min-width: 768px) and (orientation: portrait)" type="image/webp">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-ipad-vertical768.jpg}" media="(min-width: 768px) and (orientation: portrait)" type="image/jpeg">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-movil-horizontal800.webp}" media="(min-width: 0px) and (orientation: landscape)" type="image/webp">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-movil-horizontal800.jpg}" media="(min-width: 0px) and (orientation: landscape)" type="image/jpeg">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-movil450.webp}" media="(min-width: 0px) and (orientation: portrait)" type="image/webp">
            <source th:srcset="@{/assets/img/portada/portada-ucam-4-movil450.jpg}" media="(min-width: 0px) and (orientation: portrait)" type="image/jpeg">

            <img th:src="@{/assets/img/portada/portada-ucam-4-escritorio1920.jpg}" alt="Vista del monasterio de los Jerónimos | Home">
        </picture>
        <div class="form-wrapper">
            <form id="searchPortadaForm" th:action="@{/searchPersonal/}">
                <div class="input-group">
                      <span class="input-group-prepend">
                          <div class="input-group-text bg-light border-right-0"><i class="icon-lupa"></i></div>
                      </span>
                    <input id="busqueda" type="text" autocomplete="off" formControlName="userInput" class="form-control py-2 border-left-0" name="search" placeholder="Nombre, apellidos, extensión, email">
                    <button id="buscar" class="btn">Buscar</button>
                </div>
                <div id="sugerencias"></div>
            </form>
        </div>
    </section>

</article>

<script th:src="@{/assets/js/vendor/jquery.slim.min.js}"></script>
<script th:src="@{/assets/js/vendor/bootstrap.min.js}"></script>
<script th:src="@{/assets/js/vendor/popper.min.js}"></script>
<script th:src="@{/assets/js/main.scripts.js}"></script>
<script th:src="@{/assets/js/vendor/swiper.js}"></script>
<script th:src="@{/assets/js/profile.scripts.js}"></script>

<script src="//code.jquery.com/jquery-3.5.1.min.js"></script>
<script>
    $(document).ready(function() {
        var timeout = null;
        var $busqueda = $('#busqueda');
        var $sugerencias = $('#sugerencias');

        $('#busqueda').on('input', function() {
            if ($(this).val() != '') {
                $('#buscar').css('background-color', '#2d3d4a');
                $('#buscar').css('border-color', '#293742');
                $('#buscar').css('box-shadow', 'none');
            } else {
                $('#buscar').css('background-color', '#a8a8a8');
                $('#buscar').css('border-color', '#a8a8a8');
                $('#buscar').css({"box-shadow": "0 3px 1px -2px rgba(0,0,0,.2), 0 2px 2px 0 rgba(0,0,0,.14), 0 1px 5px 0 rgba(0,0,0,.12)"});
            }
        });

        $('#busqueda').on('focus', function () {
            $('#sugerencias').show();
        });

        $('#busqueda').on('blur', function () {
            clearTimeout(timeout);
            timeout = setTimeout(function() {
                $('#sugerencias').hide();
            }, 600);
        });

        $busqueda.on('keyup', function() {
            clearTimeout(timeout);
            timeout = setTimeout(function() {
                if ($busqueda.val().length >2) {
                    var $url = "/personas/searchNombres/" + $busqueda.val();

                    $.ajax({
                        type: 'GET',
                        url: $url,
                        dataType: 'html'
                    })
                    .done(function (data) {
                        $sugerencias.html(data);
                        console.log('Personas encontradas correctamente');
                    })
                    .fail(function () {
                        console.log('Error al buscar personas');
                    });
                }else{
                    $sugerencias.html("");
                }
            }, 600);
        });
    });
</script>

</body>
</html>
